# üöÄ AWS EBS Snapshot Cleaner | Automated Cost Optimization with Lambda & SNS

This project uses an AWS Lambda function to automatically identify and delete stale EBS snapshots ‚Äî including those from unattached, stopped, or deleted volumes ‚Äî and sends real-time alerts via Amazon SNS. It's a fully serverless, cost-saving automation aligned with real-world DevOps and FAANG-level infrastructure patterns.

---

## üîç Why This Matters

-  **Reduces AWS costs** by removing unused EBS snapshots that silently incur charges.
-  **Production-style architecture** with alerting and permission boundaries.
-  **FAANG-relevant tools**: AWS Lambda, IAM, EC2, SNS, boto3, infrastructure scripting.

---

## üîß Tech Stack

- **AWS Lambda** ‚Äì Serverless function to automate cleanup  
- **Amazon EC2 & EBS** ‚Äì Source of snapshots  
- **Amazon SNS** ‚Äì Sends email alerts when snapshots are deleted  
- **IAM** ‚Äì Access control via custom roles and policies  
- **Python (boto3)** ‚Äì AWS SDK to interact with EC2, Volumes, and SNS

---

## ‚úÖ Step-by-Step Deployment Guide

---

### 1. Launch an EC2 Instance & Snapshot

- Launch a test EC2 instance in any AWS region (e.g., `us-east-1`).
- Attach an EBS volume.
- Go to **EC2 ‚Üí Volumes ‚Üí Select volume ‚Üí Create Snapshot**.

üì∏ *Screenshot: EC2 instance*
![EC2 Instance](screenshots/ec2_instance.png)

üì∏ *Screenshot: Snapshot created*
![Snapshot](screenshots/snapshot.png)

---

### 2. Set Up the Lambda Function

- Go to **AWS Lambda ‚Üí Create Function**.
- Set **runtime** to **Python 3.12** or later.
- Use the code from `lambda_function.py` in this repository.
- Under **Configuration ‚Üí General**, set **timeout** to **10 seconds**.
- Deploy the function.

üì∏ *Screenshot: Lambda function created*
![Lambda Function](screenshots/lambda_function.png)

---

### 3. Set Up IAM Permissions

Attach the following permissions to your Lambda's execution role:

- `ec2:DescribeInstances`  
- `ec2:DescribeSnapshots`  
- `ec2:DescribeVolumes`  
- `ec2:DeleteSnapshot`  
- `sns:Publish`  

 *Screenshot: Custom IAM policy for ec2:DescribeInstances*
![Allow DescribeInstances](screenshots/Allow_Describe_Instances.png)

 *Screenshot: SNS Publish Permission*
![SNS Publish](screenshots/SNS_publish.png)

---

### 4. Create an SNS Topic for Alerts

- Go to **Amazon SNS ‚Üí Create Topic ‚Üí Standard**.
- Name it something like `snapshot-alerts`.
- Add a **subscription method** (e.g., **Email**).
- Confirm the subscription via the email link.

 *Screenshot: Subscription Notification*
![Subscription Notification](screenshots/Subscription_notification.png)

 *Screenshot: Subscription Confirmed*
![Subscription Confirmed](screenshots/Subscription_confirmed.png)

---

### 5. First Test: No Deletion Expected

- Keep the EC2 instance **running**.
- Run the Lambda function from the **Test** tab.
- Expected: No snapshots should be deleted.

üì∏ *Screenshot: Successful Lambda Test*
![Successful Lambda Test](screenshots/Successful_lambda_test.png)

---

### 6. Second Test: Trigger Deletion

- **Terminate the EC2 instance**.
- Run Lambda again.
- It will detect stale snapshots and:
  -  **Delete** them
  -  **Send alert** via SNS to your email

 *Screenshot: Email Notification*
![Email Notification](screenshots/Email_notification.png)

---

### üîí IAM Summary

Permissions required for Lambda role:

- `ec2:DescribeInstances`  
- `ec2:DescribeSnapshots`  
- `ec2:DescribeVolumes`  
- `ec2:DeleteSnapshot`  
- `sns:Publish`

---

## üß† What You‚Äôll Learn

- Automating snapshot cleanup workflows  
- Working with IAM and cross-service policies  
- Serverless scripting with Python and boto3  
- Integrating notifications via SNS  
- Implementing cloud cost optimization logic  

---

## üß≠ Next Steps

-  Add estimated savings log to SNS email
-  Implement tag-based retention filtering
-  Add security checks to avoid deleting tagged backups

---

## ü§ù Contributing

Feel free to fork this project, use it in production, or extend its functionality. If it helped you save on AWS billing ‚Äî give it a ‚≠ê on GitHub!
